<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Main App</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #050505;
      color: white;
      font-family: monospace;
    }
    .test {
      margin: 20px 0;
      padding: 15px;
      background: #1a1a1a;
      border-radius: 5px;
      border-left: 3px solid #a855f7;
    }
    .success { color: #22d3ee; }
    .error { color: #f43f5e; }
    button {
      padding: 10px 20px;
      background: #7e22ce;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    iframe {
      width: 100%;
      height: 600px;
      border: 1px solid #333;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>ğŸ” ä¸»åº”ç”¨æµ‹è¯•é¡µé¢</h1>
  
  <div class="test">
    <h2>1. æ£€æŸ¥ä¸»åº”ç”¨èµ„æº</h2>
    <div id="resource-check"></div>
  </div>
  
  <div class="test">
    <h2>2. æµ‹è¯•åŠ è½½ä¸»åº”ç”¨</h2>
    <button onclick="testMainApp()">æµ‹è¯•ä¸»åº”ç”¨</button>
    <button onclick="loadInIframe()">åœ¨ iframe ä¸­åŠ è½½</button>
    <div id="test-result"></div>
  </div>
  
  <div class="test">
    <h2>3. ä¸»åº”ç”¨é¢„è§ˆ</h2>
    <iframe id="main-app-frame" src="/cancri/index.html"></iframe>
  </div>
  
  <script>
    async function testMainApp() {
      const resultEl = document.getElementById('test-result');
      resultEl.innerHTML = '<p>â³ æ­£åœ¨æ£€æŸ¥...</p>';
      
      try {
        // æ£€æŸ¥ä¸»é¡µé¢
        const mainPageUrl = '/cancri/index.html';
        const res = await fetch(mainPageUrl);
        
        if (!res.ok) {
          resultEl.innerHTML = `<p class="error">âŒ ä¸»é¡µé¢è¿”å›çŠ¶æ€ç : ${res.status}</p>`;
          return;
        }
        
        const html = await res.text();
        resultEl.innerHTML = '<p class="success">âœ… ä¸»é¡µé¢å¯è®¿é—®</p>';
        
        // æ£€æŸ¥æ˜¯å¦æœ‰ root å…ƒç´ 
        if (html.includes('id="root"')) {
          resultEl.innerHTML += '<p class="success">âœ… æ‰¾åˆ° root å…ƒç´ </p>';
        } else {
          resultEl.innerHTML += '<p class="error">âŒ æœªæ‰¾åˆ° root å…ƒç´ </p>';
        }
        
        // æ£€æŸ¥è„šæœ¬
        const scriptMatches = html.match(/src="([^"]+\.js)"/g);
        if (scriptMatches) {
          resultEl.innerHTML += `<p>æ‰¾åˆ° ${scriptMatches.length} ä¸ªè„šæœ¬å¼•ç”¨</p>`;
          
          // æµ‹è¯•æ¯ä¸ªè„šæœ¬
          for (const match of scriptMatches) {
            const src = match.match(/src="([^"]+)"/)[1];
            const fullUrl = src.startsWith('http') ? src : window.location.origin + src;
            try {
              const scriptRes = await fetch(fullUrl, { method: 'HEAD' });
              if (scriptRes.ok) {
                resultEl.innerHTML += `<p class="success">âœ… ${src}</p>`;
              } else {
                resultEl.innerHTML += `<p class="error">âŒ ${src} - ${scriptRes.status}</p>`;
              }
            } catch (e) {
              resultEl.innerHTML += `<p class="error">âŒ ${src} - ${e.message}</p>`;
            }
          }
        } else {
          resultEl.innerHTML += '<p class="error">âŒ æœªæ‰¾åˆ°è„šæœ¬å¼•ç”¨</p>';
        }
        
        // æ£€æŸ¥æ ·å¼
        const styleMatches = html.match(/href="([^"]+\.css)"/g);
        if (styleMatches) {
          resultEl.innerHTML += `<p>æ‰¾åˆ° ${styleMatches.length} ä¸ªæ ·å¼è¡¨å¼•ç”¨</p>`;
          for (const match of styleMatches) {
            const href = match.match(/href="([^"]+)"/)[1];
            const fullUrl = href.startsWith('http') ? href : window.location.origin + href;
            try {
              const styleRes = await fetch(fullUrl, { method: 'HEAD' });
              if (styleRes.ok) {
                resultEl.innerHTML += `<p class="success">âœ… ${href}</p>`;
              } else {
                resultEl.innerHTML += `<p class="error">âŒ ${href} - ${styleRes.status}</p>`;
              }
            } catch (e) {
              resultEl.innerHTML += `<p class="error">âŒ ${href} - ${e.message}</p>`;
            }
          }
        }
        
      } catch (e) {
        resultEl.innerHTML = `<p class="error">âŒ æ£€æŸ¥å¤±è´¥: ${e.message}</p>`;
      }
    }
    
    function loadInIframe() {
      const iframe = document.getElementById('main-app-frame');
      iframe.src = '/cancri/index.html';
      iframe.onload = () => {
        console.log('Main app loaded in iframe');
      };
      iframe.onerror = (e) => {
        console.error('Failed to load main app:', e);
      };
    }
    
    // è‡ªåŠ¨æ£€æŸ¥èµ„æº
    window.addEventListener('load', () => {
      testMainApp();
    });
  </script>
</body>
</html>



